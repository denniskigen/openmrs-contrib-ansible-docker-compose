<VirtualHost *:80>
  <Location "/openmrs/ws/rest/v1">
    <IfModule mod_headers.c>
      SetEnvIf Origin "https://(openmrs-spa\.org)$" AccessControlAllowOrigin=$0
      Header set Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
      Header set Access-Control-Allow-Methods "POST, GET, OPTIONS, PUT, DELETE"
      Header set Access-Control-Allow-Headers "Authorization, Authorization, Content-Type"
      Header set Access-Control-Max-Age "Access-Control-Max-Age: 86400"
    </IfModule>
  </Location>

  # Frontend
  ProxyPass /openmrs/spa http://frontend:8080/ui
  ProxyPassReverse /openmrs/spa http://frontend:8080/ui

  ProxyPass /favicon.ico http://frontend:8080/ui/favicon.ico
  ProxyPassReverse /favicon.ico http://frontend:8080/ui/favicon.ico

  # OpenMRS
  ProxyPass /openmrs http://openmrs:8080/openmrs
  ProxyPassReverse /openmrs http://openmrs:8080/openmrs

  # Conveniently redirect / to SPA path
  RewriteEngine on
  RewriteCond %{REQUEST_URI} ^/$
  RewriteRule (.*) /openmrs/spa/ [R=303,L]
</VirtualHost>